labs(title = "Number of student enrollments by session",
x = "Session", y = "Numbers of students")
plot_num_of_students
num_of_students_per_run
plot_num_of_students <- ggplot(num_of_students_per_run, aes(x=run, y=n)) +
geom_line() +
geom_point() +
xlim(0, 7) +
ylim(0, 15000) +
theme_light() +
labs(title = "Number of student enrollments by session",
x = "Session", y = "Numbers of students")
plot_num_of_students
plot_num_of_students <- ggplot(num_of_students_per_run, aes(x=run, y=n)) +
geom_line() +
geom_point(colour="red") +
xlim(0, 7) +
ylim(0, 15000) +
theme_light() +
labs(title = "Number of student enrollments by session",
x = "Session", y = "Numbers of students")
plot_num_of_students
plot_num_of_students <- ggplot(num_of_students_per_run, aes(x=run, y=n)) +
geom_line() +
geom_point(colour="orange") +
xlim(0, 7) +
ylim(0, 15000) +
theme_light() +
labs(title = "Number of student enrollments by session",
x = "Session", y = "Numbers of students")
plot_num_of_students
plot_num_of_students <- ggplot(num_of_students_per_run, aes(x=run, y=n)) +
geom_line() +
geom_point(colour="red") +
xlim(0, 7) +
ylim(0, 15000) +
theme_light() +
labs(title = "Number of student enrollments by session",
x = "Session", y = "Numbers of students")
plot_num_of_students
countries <- all_enrolments %>%
# mutate_if(is.factor, as.character) %>%
select(detected_country) %>%
count(detected_country) %>%
mutate(detected_country = replace(detected_country, detected_country == "--", NA)) %>%
drop_na() %>%
arrange(desc(n))
countries
head(countries)
ggplot(countries, aes(x=detected_country, y=n)) +
geom_point(aes(colour=detected_country), size = 2, show.legend = FALSE) +
geom_text(aes(detected_country, label = detected_country), nudge_x = 3) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
install.packages("countrycode")
install.packages("countrycode")
install.packages("countrycode")
library(countrycode)
countries
countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name"))
countries
countrycode(countries$detected_country)
countrycode(countries$detected_country, "iso2c", "country.name")
countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = "XK" = "Kosovo"))
countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = ("XK" = "Kosovo")))
countries_w_name <- countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = ("XK" = "Kosovo")))
countries_w_name
countries
countries_w_name <- countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = ("XK" = "Kosovo"))) %>%
mutate(region = countrycode(sourcevar = country_name,
origin = "country.name",
destination = "region",
custom_match = ("XK" = "Europe")))
countries_w_name
tail(countries_w_name)
is.na(countries_w_name)
which(is.na(countries_w_name))
which(is.na(countries_w_name))
countries_w_name[597]
countries_w_name[, 597]
countries_w_name[597, ]
countries[597, ]
countries[596, ]
countries[595, ]
countries[105, ]
countries[651, ]
countries[199, ]
which(is.na(countries_w_name))
countries_w_name
tail(countries_w_name)
countrycode(countries_w_name, custom_match = ("XK" = "Kosovo")
countrycode(countries_w_name, custom_match = ("XK" = "Kosovo"))
which(is.na(countries_w_name))
countrycode(detected_country,"iso2c","country.name", custom_match = ("XK" = "Kosovo")
countrycode(detected_country,"iso2c","country.name", custom_match = ("XK" = "Kosovo"))
countrycode(countries_w_name(detected_country,"iso2c","country.name", custom_match = ("XK" = "Kosovo")))
countries_w_name <- countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name")) %>%
mutate(region = countrycode(sourcevar = country_name,
origin = "country.name",
destination = "region")) %>%
na.omit()
countries_w_name
tail(countries_w_name)
countries_w_name <- countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = c("XK" = "Kosovo"))) %>%
mutate(region = countrycode(sourcevar = country_name,
origin = "country.name",
destination = "region")) %>%
na.omit()
tail(countries_w_name)
countries_w_name["Réunion"]
countries_w_name[countries_w_name$region == "Réunion"]
countries_w_name[countries_w_name$country_name == "Réunion"]
countries_w_name <- countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = c("XK" = "Kosovo"))) %>%
mutate(region = countrycode(sourcevar = country_name,
origin = "country.name",
destination = "region"))
countries_w_name
which(is.na(countries_w_name))
countries_w_name[countries_w_name == 789]
countries_w_name %>%
filter("Réunion")
View(countries_w_name)
View(countries_w_name)
View(countries)
View(countries)
View(countries_w_name)
View(countries_w_name)
countries_w_name <- countries %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = c("XK" = "Kosovo"))) %>%
mutate(region = countrycode(sourcevar = country_name,
origin = "country.name",
destination = "region",
custom_match = c("Réunion" = "Sub-Saharan Africa")))
which(is.na(countries_w_name))
countries_w_name
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 2, show.legend = FALSE) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)"
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 2, show.legend = FALSE) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name)) +
geom_point(aes(colour=region), size = 2, show.legend = FALSE) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name)) +
geom_point(aes(colour=region), size = 2, show.legend = FALSE) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
scale_x_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name)) +
geom_point(aes(colour=region), size = 2, show.legend = FALSE) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
scale_x_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name)) +
geom_point(aes(colour=region), size = 2, show.legend = FALSE) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
# scale_x_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 2, show.legend = FALSE) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name)) +
geom_tile()
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 4) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 4) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel() +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 4) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
ggrepel::geom_text_repel() +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggrepel::geom_text_repel
install.packages("ggrepel")
library(ggrepel)
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 4) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel() +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 4) +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 4) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n)) +
geom_point(aes(colour=region), size = 4) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name), label.size=0.25) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n), group=region) +
geom_point(aes(colour=region), size = 4) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name), label.size=0.25) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n), group=region) +
geom_point(aes(colour=region, shape=region), size = 4) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name), label.size=0.25) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n), group=region) +
geom_boxplot(aes(colour=country_name)) +
geom_jitter(aes(colour=country_name)) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n), group=region) +
geom_boxplot(aes(colour=country_name)) +
geom_jitter(aes(colour=country_name)) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
# scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n), group=region) +
geom_boxplot(aes(colour=country_name)) +
geom_jitter(aes(colour=country_name)) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
# scale_y_log10() +
theme_minimal() +
# theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=country_name, y=n), group=region) +
geom_boxplot(aes(colour=region)) +
geom_jitter(aes(colour=region)) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
# scale_y_log10() +
theme_minimal() +
# theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=region, y=n), group=region) +
geom_boxplot(aes(colour=region)) +
geom_jitter(aes(colour=country_name)) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
# scale_y_log10() +
theme_minimal() +
# theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name), group=region) +
geom_point(aes(colour=region), size = 4) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
scale_x_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name), group=region) +
geom_point(aes(colour=region), size = 4, group=region) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
scale_x_log10() +
theme_minimal() +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name, fill=region)) +
geom_boxplot() +
geom_jitter()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
scale_y_log10() +
theme_minimal()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
scale_y_log10() +
geom_text(aes(country_name, label = country_name), nudge_x = 3) +
theme_minimal()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
scale_y_log10() +
geom_text(aes(label = country_name), nudge_x = 3) +
theme_minimal()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
scale_y_log10() +
geom_text_repel(aes(label=country_name)) +
theme_minimal()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter(alpha=0.2) +
scale_y_log10() +
geom_text_repel(aes(label=country_name)) +
theme_minimal()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter(width=0.1) +
scale_y_log10() +
geom_text_repel(aes(label=country_name)) +
theme_minimal()
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_point(position=position_jitterdodge(),alpha=0.3) +
scale_y_log10() +
geom_text_repel(aes(label=country_name)) +
theme_minimal()
View(countries_1)
View(countries_1)
countries_1 <- all_enrolments %>%
group_by(run, detected_country) %>%
count(detected_country) %>%
mutate(detected_country = replace(detected_country, detected_country == "--", NA)) %>%
drop_na() %>%
mutate(country_name = countrycode(sourcevar = detected_country,
origin = "iso2c",
destination = "country.name",
custom_match = c("XK" = "Kosovo"))) %>%
mutate(region = countrycode(sourcevar = country_name,
origin = "country.name",
destination = "region",
custom_match = c("Réunion" = "Sub-Saharan Africa")))
View(countries_1)
View(countries_1)
which(is.na(countries_1))
ggplot(countries_1, aes(x=run, y=detected_country, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~run)
ggplot(countries_1, aes(x=run, y=detected_country, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~region)
ggplot(countries_1, aes(x=detected_country, y=run, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~region)
ggplot(countries_1, aes(x=run, y=region, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~run)
ggplot(countries_1, aes(x=run, y=country_name, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~region)
ggplot(countries_1, aes(x=run, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~region)
ggplot(countries_1, aes(x=run, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~run)
ggplot(countries_1, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
facet_wrap(~run)
ggplot(countries_1, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
scale_y_log10() +
facet_wrap(~run)
ggplot(countries_1, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_jitter() +
scale_y_log10() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
facet_wrap(~run)
ggplot(countries_w_name, aes(x=country_name, y=n), group=region) +
geom_point(aes(colour=region), size = 4) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
scale_y_log10() +
theme_minimal() +
theme(axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=n, y=country_name), group=region) +
geom_point(aes(colour=region), size = 4) +
# geom_text(aes(country_name, label = country_name), nudge_x = 3) +
geom_text_repel(aes(label=country_name)) +
scale_x_log10() +
theme_minimal() +
theme(axis.ticks.y = element_blank(), axis.text.y = element_blank()) +
labs(title = "Number of student enrolments by country",
x = "Country", y = "Numbers of enrolment (log scale)")
ggplot(countries_w_name, aes(x=region, y=n, fill=region)) +
geom_boxplot() +
geom_point(position=position_jitterdodge(),alpha=0.3) +
scale_y_log10() +
geom_text_repel(aes(label=country_name)) +
theme_minimal()
